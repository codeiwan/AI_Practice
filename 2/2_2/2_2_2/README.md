[Home](./../../../README.md) | [인공 지능의 딥러닝 알고리즘](./../../README.md) | [다양한 인공 신경망 구현해 보기](./../README.md) | 2입력 2출력 인공 신경망 구현하기

## 2입력 2출력 인공 신경망 구현하기
다음 그림은 입력2 출력2로 구성된 인공 신경망을 나타낸다.  
![Image](https://github.com/user-attachments/assets/3c7cc9dc-426f-48f0-b9f0-11136d847a36)  

[그림1]은 순전파 과정에 필요한 변수와 수식을 나타낸다.  
[그림2]는 역전파에 필요한 변수이다. 순전파에 대응되는 변수가 모두 필요하다.  
[그림3]은 입력의 역전파에 필요한 변수와 수식을 나타낸다.  
[그림4]는 가중치와 편향의 역전파에 필요한 변수와 수식을 나타낸다.  
(※ ② x1b, x2b값은 앞부분에 또 다른 인공 신경과 연결되어 있을 경우 y1b, y2b처럼 해당 인공 신경으로 역전파 되는 값이다.  
역전파된 x1b, x2b값은 해당 인공 신경의 가중치와 편향 학습에 사용된다.)

이상에서 필요한 수식을 정리하면 다음과 같다.

순전파  
$x_1 w_1 + x_2 w_2 + 1 b_1 = y_1$  
$x_1 w_3 + x_2 w_4 + 1 b_2 = y_2$

입력 역전파  
$y_{1b} w_1 + y_{2b} w_3 = x_{1b}$  
$y_{1b} w_2 + y_{2b} w_4 = x_{2b}$

가중치, 편향 역전파  
$x_1 y_{1b} = w_{1b}$  
$x_2 y_{1b} = w_{2b}$  
$x_1 y_{2b} = w_{3b}$  
$x_2 y_{2b} = w_{4b}$  
$1y_{1b} = b_{1b}$  
$1y_{2b} = b_{2b}$

인공 신경망 학습  
$w_1 = w_1 - aw_{1b}$  
$w_2 = w_2 - aw_{2b}$  
$w_3 = w_3 - aw_{3b}$  
$w_4 = w_4 - aw_{4b}$  
$b_1 = b_1 - ab_{1b}$  
$b_2 = b_2 - ab_{2b}$

지금까지 정리한 수식을 구현을 통해 살펴보자.  
![Image](https://github.com/user-attachments/assets/076a0730-4e55-4be8-a977-e58be7ca90fe)  
이 그림에서 입력 값 x1, x2는 각각 2, 3  
가중치 w1, w2, 편향 b1은 각각 3, 4, 1,  
가중치 w3, w4, 편향 b2는 각각 5, 6, 2이고  
목표 값 t1, t2는 각각 27, -30이다.  
x1, x2를 상수로 고정한 채 w1, w2, w3, w4, b1, b2에 대해 학습을 수행해 보자.

다음과 같이 예제를 작성한다.
```python
x1, x2 = 2, 3
t1, t2 = 27, -30
w1, w3 = 3, 5
w2, w4 = 4, 6
b1, b2 = 1, 2

for epoch in range(2000):

    print(f'epoch = {epoch}')

    y1 = x1*w1 + x2*w2 + 1*b1
    y2 = x1*w3 + x2*w4 + 1*b2
    print(f' y1,  y2  = {y1:6.3f}, {y2:6.3f}')

    E = (y1-t1)**2/2 + (y2-t2)**2/2
    print(f' E  = {E:.7f}')
    if E < 0.0000001:
        break

    y1b, y2b = y1 - t1, y2 - t2
    x1b, x2b = y1b*w1 + y2b*w3, y1b*w2 + y2b*w4
    w1b, w3b = x1*y1b, x1*y2b
    w2b, w4b = x2*y1b, x2*y2b
    b1b, b2b = 1*y1b, 1*y2b
    print(f' x1b, x2b = {x1b:6.3f}, {x2b:6.3f}')
    print(f' w1b, w3b = {w1b:6.3f}, {w3b:6.3f}')
    print(f' w2b, w4b = {w2b:6.3f}, {w4b:6.3f}')
    print(f' b1b, b2b = {b1b:6.3f}, {b2b:6.3f}')

    lr = 0.01
    w1, w3 = w1 - lr*w1b, w3 - lr*w3b
    w2, w4 = w2 - lr*w2b, w4 - lr*w4b
    b1, b2 = b1 - lr*b1b, b2 - lr*b2b
    print(f' w1,  w3  = {w1:6.3f}, {w3:6.3f}')
    print(f' w2,  w4  = {w2:6.3f}, {w4:6.3f}')
    print(f' b1,  b2  = {b1:6.3f}, {b2:6.3f}')
```
- x1b, x2b 변수를 선언한 후, 입력 값에 대한 역전파 값을 받아본다.  
이 부분은 이 예제에서 필요한 부분은 아니며, 역전파 연습을 위해 추가하였다.
