[Home](./../../../README.md) | [인공 지능의 딥러닝 알고리즘](./../../README.md) | [다양한 인공 신경망 구현해 보기](./../README.md) | 2입력 1출력 인공 신경 구현하기

## 2입력 1출력 인공 신경 구현하기
다음 그림은 입력2 출력1로 구성된 인공 신경을 나타낸다.

![Image](https://github.com/user-attachments/assets/0ff01e93-0df4-476f-a4cb-ed0c52d08d6e)

[그림1]은 순전파 과정에 필요한 변수와 수식을 나타낸다.  
[그림2]는 역전파에 필요한 변수이다. 순전파에 대응되는 변수가 모두 필요하다.  
[그림3]은 입력의 역전파에 필요한 변수와 수식을 타나낸다.  
[그림4]는 가중치와 편향의 역전파에 필요한 변수와 수식을 나타낸다.  
(※ ② x1b, x2b값은 앞부분에 또 다른 인공 신경과 연결되어 있을 경우 yb처럼 해당 인공 신경으로 역전파되는 값이다.  
역전파된 x1b, x2b값은 해당 인공 신경의 가중치와 편향 학습에 사용된다.)

이상에서 필요한 수식을 정리하면 다음과 같다.
- 순전파  
$x_1 w_1 + x_2 w_2 + 1 b = y$
- 입력 역전파  
$y_b w_1 = x_{1b}$  
$y_b w_2 = x_{2b}$
- 가중치, 편향 역전파  
$x_1 y_b = w_{1b}$  
$x_2 y_b = w_{2b}$  
$1 y_b = b_b$
- 인공 신경망 학습  
$w_1 = w_1 - aw_{1b}$  
$w_2 = w_2 - aw_{2b}$  
$b = b - ab_b$

지금까지 정리한 수식을 구현을 통해 살펴보자.  
다음 그림을 살펴보겠다.  
![Image](https://github.com/user-attachments/assets/ed71a2f0-f463-4e38-8f38-02be8212385e)  
이 그림에서 입력 값 x1, x2는 각각 2, 3, 가중치 w1, w2는 각각 3, 4, 편향 b는 1이고 목표 값 t는 27이다.  
x1, x2를 상수로 고정한 채 w1, w2, b에 대해 학습을 수행해 보겠다.

다음과 같이 예제를 작성한다.
```python
x1, x2 = 2, 3
t = 27
w1 = 3
w2 = 4
b = 1

for epoch in range(20000):

    print(f'epoch = {epoch}')

    y = x1*w1 + x2*w2 + 1*b
    print(f' y  = {y:6.3f}')

    E = (y - t)**2 / 2
    print(f' E  = {E:.7f}')
    if E < 0.0000001:
        break

    yb = y - t
    x1b, x2b = yb*w1, yb*w2
    w1b = yb*x1
    w2b = yb*x2
    bb = yb*1
    print(f' x1b, x2b = {x1b:6.3f}, {x2b:6.3f}')
    print(f' w1b, w2b, bb = {w1b:6.3f}, {w2b:6.3f}, {bb:6.3f}')

    lr = 0.01
    w1 = w1 - lr*w1b
    w2 = w2 - lr*w2b
    b = b - lr*bb
    print(f' w1,  w2,  b  = {w1:6.3f}, {w2:6.3f}, {b:6.3f}')
```
- x1b, x2b 변수를 선언한 후, 입력 값에 대한 역전파 값을 받아본다.  
이 부분은 역전파 학습을 위해 추가하였다.

다음은 실행 결과 화면이다.
```
epoch = 64
 y  = 26.999
 E  = 0.0000001
 x1b, x2b = -0.002, -0.003
 w1b, w2b, bb = -0.001, -0.002, -0.001
 w1,  w2,  b  =  4.143,  5.714,  1.571
epoch = 65
 y  = 27.000
 E  = 0.0000001
```
65(64+1)회 째 학습이 완료되는 것을 볼 수 있다.  
가중치 w1, w2는 각각 4.143, 5.714, 편향 b는 1.57에 수렴한다.
