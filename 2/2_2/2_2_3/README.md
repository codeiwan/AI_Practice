[Home](./../../../README.md) | [인공 지능의 딥러닝 알고리즘](./../../README.md) | [다양한 인공 신경망 구현해 보기](./../README.md) | 3입력 3출력 인공 신경망 구현하기

## 3입력 3출력 인공 신경망 구현하기
다음 그림은 입력3 출력3으로 구성된 인공 신경망을 나타낸다.  
![Image](https://github.com/user-attachments/assets/6f9971b9-62c4-4bff-b67e-074a654b9b1f)  
[그림1]은 순전파 과정에 필요한 변수와 수식을 나타낸다.  
[그림2]는 역전파에 필요한 변수입니다. 순전파에 대응되는 변수가 모두 필요한다.  
[그림3]은 입력의 역전파에 필요한 변수와 수식을 나타낸다.  
[그림4]는 가중치와 편향의 역전파에 필요한 변수와 수식을 나타낸다.  
(※ x1b, x2b, x3b값은 앞부분에 또 다른 인공 신경과 연결되어 있을 경우 y1b, y2b, y3b처럼 해당 인공 신경으로 역전파되는 값이다.  
역전파된 x1b, x2b, x3b값은 해당 인공 신경의 가중치와 편향 학습에 사용된다.)

이상에서 필요한 수식을 정리하면 다음과 같다.  
![Image](https://github.com/user-attachments/assets/28d55fb4-6a78-4d01-bd0a-a73e24f94871)

지금까지 정리한 수식을 구현을 통해 살펴보자.  
![Image](https://github.com/user-attachments/assets/94e000ec-df54-4703-8632-73e459a2df2e)  
이 그림에서 입력 값 x1, x2, x3은 각각 2, 3, 4, 가중치 w1, w2, w3, 편향 b1은 각각 3, 4, 5, 1, 가중치 w4, w5, w6, 편향 b2는 각각 5, 6, 7, 2, 가중치 w7, w8, w9, 편향 b3은 각각 8, 9, 10, 3이고 목표 값 t1, t2, t3은 각각 27, -30, 179이다.  
x1, x2, x3를 상수로 고정한 채 w1~w9, b1~b3에 대해 학습을 수행해 보겠다.  
(※ 이 값들은 임의의 값들이다. 다른 값들을 사용하여 학습을 수행할 수도 있다.)

다음과 같이 예제를 작성한다.
```python
x1, x2, x3 = 2, 3, 4
t1, t2, t3 = 27, -30, 179
w1, w4, w7 = 3, 5, 8
w2, w5, w8 = 4, 6, 9
w3, w6, w9 = 5, 7, 10
b1, b2, b3 = 1, 2, 3

for epoch in range(2000):

    print(f'epoch = {epoch}')

    y1 = x1*w1 + x2*w2 + x3*w3 + 1*b1
    y2 = x1*w4 + x2*w5 + x3*w6 + 1*b2
    y3 = x1*w7 + x2*w8 + x3*w9 + 1*b3
    print(f' y1,  y2,  y3  = {y1:6.3f}, {y2:6.3f}, {y3:6.3f}')

    E = (y1-t1)**2/2 + (y2-t2)**2/2 + (y3-t3)**2/2
    print(f' E  = {E:.7f}')
    if E < 0.0000001:
        break

    y1b, y2b, y3b = y1 - t1, y2 - t2, y3 - t3
    x1b = y1b*w1 + y2b*w4 + y3b*w7
    x2b = y1b*w2 + y2b*w5 + y3b*w8
    x3b = y1b*w3 + y2b*w6 + y3b*w9
    w1b, w4b, w7b = x1*y1b, x1*y2b, x1*y3b
    w2b, w5b, w8b = x2*y1b, x2*y2b, x2*y3b
    w3b, w6b, w9b = x3*y1b, x3*y2b, x3*y3b
    b1b, b2b, b3b = 1*y1b, 1*y2b, 1*y3b,
    print(f' x1b, x2b, x3b = {x1b:6.3f}, {x2b:6.3f}, {x3b:6.3f}')
    print(f' w1b, w4b, w7b = {w1b:6.3f}, {w4b:6.3f}, {w7b:6.3f}')
    print(f' w2b, w5b, w8b = {w2b:6.3f}, {w5b:6.3f}, {w8b:6.3f}')
    print(f' w3b, w6b, w9b = {w3b:6.3f}, {w6b:6.3f}, {w9b:6.3f}')
    print(f' b1b, b2b, b3b = {b1b:6.3f}, {b2b:6.3f}, {b3b:6.3f}')

    lr = 0.01
    w1, w4, w7 = w1 - lr*w1b, w4 - lr*w4b, w7 - lr*w7b
    w2, w5, w8 = w2 - lr*w2b, w5 - lr*w5b, w8 - lr*w8b
    w3, w6, w9 = w3 - lr*w3b, w6 - lr*w6b, w9 - lr*w9b
    b1, b2, b3 = b1 - lr*b1b, b2 - lr*b2b, b3 - lr*b3b
    print(f' w1,  w4,  w7  = {w1:6.3f}, {w4:6.3f}, {w7:6.3f}')
    print(f' w2,  w5,  w8  = {w2:6.3f}, {w5:6.3f}, {w8:6.3f}')
    print(f' w3,  w6,  w9  = {w3:6.3f}, {w6:6.3f}, {w9:6.3f}')
    print(f' b1,  b2,  b3  = {b1:6.3f}, {b2:6.3f}, {b3:6.3f}')
```

다음은 실행 결과 화면이다.
```
epoch = 35
 y1,  y2,  y3  = 27.000, -30.000, 179.000
 E  = 0.0000001
 x1b, x2b, x3b = -0.005, -0.007, -0.009
 w1b, w4b, w7b =  0.000,  0.001, -0.001
 w2b, w5b, w8b =  0.000,  0.001, -0.001
 w3b, w6b, w9b =  0.000,  0.001, -0.001
 b1b, b2b, b3b =  0.000,  0.000, -0.000
 w1,  w4,  w7  =  2.200, -0.867, 14.200
 w2,  w5,  w8  =  2.800, -2.800, 18.300
 w3,  w6,  w9  =  3.400, -4.733, 22.400
 b1,  b2,  b3  =  0.600, -0.933,  6.100
epoch = 36
 y1,  y2,  y3  = 27.000, -30.000, 179.000
 E  = 0.0000001
```
37(36+1)회 째 학습이 완료되는 것을 볼 수 있다.  
가중치 w1~w9, 편향 b1~b3이 수렴하는 값도 볼 수 있다.
